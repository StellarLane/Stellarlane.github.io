---
title: 双系统安装记录
category: CSDIY
tags:
  - linux
date: 2024-05-30
---

# 双系统安装记录

由于实在受不了我电脑上virtualbox过于羸弱的性能，我尝试在我的两台电脑上都安装了win&ubuntu双系统。不得不说安装流程比我想象中的简单太多，安装后两个系统也都非常流畅。不过中间还是踩了不少坑，也重装了几次系统，现将过程记录如下，以飨后人。

> 本文以在一台已安装windows11的电脑上安装ubuntu 24.04 LTS为例

## 前期准备

1. 下载ubuntu的iso文件，使用rufus工具制作系统盘，将rufus设置中分区类型设为GPT，文件系统设置为NTFS
2. 系统信息上查看BIOS模式是否为UEFI
3. 设置中搜索并关闭bitlocker（家庭版没有bitlocker可忽略此步骤）
4. 控制面板-硬件与声音-电源选项-系统设置-电源按钮功能-关闭“启用快速启动”
5. 计算机管理-磁盘管理中清理出一个未分配的空间(具体多少可看个人需求)
6. 插入制作好的系统盘
7. 进入BIOS模式-安全模式-关闭安全启动
8. 进入BIOS模式-启动设置中UEFI启动顺序为USB闪存驱动器/硬盘
9. 保存并退出

## 安装中

此时再重启就会进入grub菜单，grub是一个启动加载程序，可以管理多个操作系统的启动，如果已做好安装ubuntu的相关准备即可选择grub菜单中的“try or install ubuntu”项
时至24.04,安装大部分是图形化界面，大部分都可以保持默认或者根据提示确定自己的需求，非常轻松愉快。稍微需要注意的是安装类型：需选择“其他选项”，之前清理出的未分配空间会显示为空闲，选择创建大小为16GB的分区，类型为交换空间（似乎在更老版本的ubuntu中可以选择分区的类型（主/逻辑分区）和分区位置（空间起始/结束），似乎24.04没有这里两个设置选项），划分50gb，用于ext4日志文件系统，挂载点为/，剩余空间同样设置为ext4日志文件系统，挂载点改为/home
然后就继续正常安装流程，安装成功重启之后拔出u盘，安装过程就基本结束了～

## 后话

### grub美化

您应该也注意到了默认的grub是比较有一种复古的美的，如果您希望您的开屏页能更现代/花里胡哨的话，也可以修改grub的样式，最简单的就是更改grub主题。您可以在[Gorgeous-GRUB](https://github.com/jacksaur/Gorgeous-GRUB)等网站上找到诸多精美的Grub主题，在Linux系统上下载并解压之后，运行其自带的install脚本即可安装

### 安装时的bug

在安装时有个界面是让你输入用户名和密码等，同时系统会根据你所输入的用户名和电脑本身自动生成设备名，**不要修改其自动生成的设备名**，可能会导致安装流程直接卡死，需要重新开始安装流程等问题

### 文件系统的陷阱

**5.29 update:今天笔者遇见了和这次一样的问题，后文记载了这次遇到时笔者如何不重装系统解决此问题**
作为一个电脑小白，我对操作系统的文件管理原理是一无所知的。在我当时用virtualbox的时候就因为不能在win和虚拟机间方便地互传文件而相当苦恼，而在这次安装了ubuntu之后，我惊喜的发现可以在ubuntu中访问本来没有划入ubuntu分区部分空间。于是我十分开心的从其中找到了几张图片设为壁纸。
然后就开不了机了，报错信息为

```
fsckd-cancel-msg： Ctrl+C ...
```

我查了一下网上这个报错是由检验系统文件完整性的工具发出，大多是因为根目录空间占满了而触发，但照理说我刚下在应该不会出现这样的问题，后来我回想感觉应该就是因为我设置的壁纸本身的空间不在ubuntu系统内，导致了文件检验没有通过。后续我发现将其他分区的文件复制到系统内是没问题的，但不能直接去随意使用系统外分区存储的文件。（不确定这个解释是否正确）
这个问题理论上应该可以通过进入recovery模式解决，当然对我这种啥都不懂的还是直接重装吧。
**8.24 update**前几天帮朋友装了双系统，尝试复现但似乎没有出问题。不过总之对待未挂载的目录里的文件应该还是稳健为妙。

### 远离自带的App商店！

在自带商店下载vscode后，我发现我不能在其中输入中文，原因就是商店中下载的snap版本vscode是不完整的，到vscode官网上自行下载deb包即可。

### 桌面环境崩溃，以及解决方案

在5.29下午一次寻常的自动熄屏之后，我试图重新打开，然后在解锁界面，我输入了正确的密码之后密码框提示'authentication error'然后就卡死了，当时我就吓晕了，因为这集我见过，果然卡死之后我尝试重启，遇见了之前一样的情况，提示gnome崩溃，无法进入图形界面。
由于已经用了一段时间，这时若直接重装系统来解决问题的话，数据丢失的成本难免有些大。而且我记得我已经有很久没有开过windows系统了，应该没有什么问题。在进入recovery模式后，我注意到仍然没有网络上其他此类状况触发时的磁盘空间占满的情况，此时我注意到有帖子称这可能只是单纯的gnome桌面环境崩溃，于是尝试了在rec下重装桌面环境

```bash
apt remove gdm3
apt install gdm3
```

重启之后就可以正常进入了，不过这个安装的桌面环境和原版还是略有不同(我的在安装后找不到文件管理器)，可能是因为安装的gnome和原版不太一样，若想还原之前的体验可继续下在ubuntu的定制版gnome

```bash
sudo apt install ubuntu-desktop gnome-shell-extension-ubuntu-dock
```

经查证，此事件大概率是因为在我当时为了打开AppImage安装了老版fuse，安装老版fuse时破坏了桌面环境。

### 关闭wayland协议

wayland协议是一种用来构建用户界面的协议，以替代传统的协议，达到更高效，更美观，更安全的目的，但架不住某些一如既往地不爱遵守规则的软件厂商不用此协议，比如在安装腾讯会议后，我试图打开，其就会显示不兼容wayland协议，程序即将退出。关闭wayland的解决方案如下（好像也可以不关闭，在腾讯会议中绕过，但这样好像会导致一些bug我就没用）

```bash
sudo vim /etc/gdm3/custom.conf
#WaylandEnable=False  本行默认为注释状态，取消注释
sudo service gdm3 restart
```

## 结语

希望上述内容能帮到您，祝您安装顺利，使用愉快😚
